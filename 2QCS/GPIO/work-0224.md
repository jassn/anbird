# RS232 (COM1 UART)

- [x] qupv3_se5_2uart: uart@a94000
- [x] trustzone
- [ ] pinctrl 
- [ ] qupv3_se5_2uart_pins (vs qupv3_se2_4uart_pins)
- [ ] * (vs qupv3_se2_default_tx)
- [x] io_expander_1, from 9 to 4 ??


find a94000 in `dts directory`

a94000 --> qupv3_se5_2uart











- [ ] 80-70023-8 UART
- [ ] https://docs.qualcomm.com/doc/80-70023-8/topic/uart.html
- [ ] 80-50445-21
- [ ] 80-88500-1: 2.1 Pin control
- [ ] 80-88500-1: 3.3 UART in QUP
- [ ] [gpio.txt](https://github.com/torvalds/linux/blob/master/Documentation/devicetree/bindings/gpio/gpio.txt)

ls /sys/class/tty

| TTY      | address |  QUP  | GPIO  | Remark  |
| -------- | ------- | :---: | ----- | ------- |
| ttyHS0   | 898000  | 14    | 76-79 | BT UART |
| ttyHS1   | a90000  |  4    | 44-47 | SER0 M.2 E-key |
| tty ?    | a94000  |  5    | 52-55 | COM1    |
| ttyHS5   | a88000  |  2    | 36-39 | COM2    |
| ttyMSM0  | a9c000  |  7    | 24-27 | Debug   |


## QUP Status
從 Device Tree 看該 UART node 的 status, 例如: 從 kalama target 看, `qupv3_se4_4uart status = OK`.


@kalama, qupv3_se4_4uart
```
cd /proc/device-tree/soc
```

Check status of device tree
```
cat qcom,qupv3_1_geni_se@ac0000/uart@a90000/status
```

Also, you can check `/sys/class/tty` as well.



--------------------------------------------------------------
##  SP339     
https://www.maxlinear.com/product/interface/serial-transceivers/multiprotocol/dual-protocol/sp339



## TCAL6416     
https://www.ti.com/document-viewer/tcal6416/datasheet




----------------------------------------------------------------------

# 80-50430-5  8550 Technical Reference
4.5.1 Qualcomm Snapdragon sensor core
* 80-88500-1, 3.8 Debug sensor core

QUP GPIO mapping (CDP/MTP/QRD/HDK)

4.9.2 QUP ports (I2C, I3C, SPI, and UART)
1. Pin configuration: TLMM_QPIO_CFG
2. Protocol selection.





----------------------------------------------------------------------

# 80-50445-21

QCS8550_QCM8550_QCM8538_Linux_Android_Peripheral__UART__SPI__I2C__I3C__Technical_Overview.pdf

QUPs - Qualcomm Universal Peripheral v3

UART Core

Device Tree Configuration - QUPv3



----------------------------------------------------------------------
# 80-NR553-2

2.2 QUP firmware

3.0 UART in QUP v3





----------------------------------------------------------------------
# 80-70022-3
10.3 Configure GPIOS from the user space
* gpioinfo

----------------------------------------------------------------------
# 80-70022-8
## 3.2 Load QUP v3 serial engine firmware
* QUPAC_Access.c
* Sample UART configuration


## 4.0  UART

4.3 UART software device tree configuration

4.8 Verify UART interface

## 11.4 QUP v3 firmware status verification
The firmware is delivered at `Non-HLOS/common/core_qupv3fw/kailua/qupv3fw.elf`

Check GENI_FW_REVISION_RO (0xa8c068) in `kernel_platform/msm-kernel/`

Modify the `QUPAC_Access.c` file configuration only.

```
msm_geni_serial_xxx: Invalid FW 255 loaded.
```




----------------------------------------------------------------------
# 80-88500-1
## 3 Qualcomm universal peripheral (QUP)     
[RB5 QUP](https://docs.qualcomm.com/doc/80-88500-1/topic/16_Qualcomm_universal_peripheral__QUP_.html)

QUP SE 12  -  0xA90000  -  Debug UART    
GPIO 32-35

### 3.2 Customize access control
```
trustzone_images/core/settings
QUPAC_Access.c
```

### 3.3 UART in QUP
3.3.1 Configure UART in kernel

3.3.2 UART driver code walkthrough

3.3.3 Debug UART in kernel


The interaction between the QUP v3 and the hardware entities occurs through system memory using the general-purpose interface (GPI) software.

RB5 device contains 28 QUPs: 20 QUPs for GPIO and 8 QUPs for the sensor low-power island (SLPI).

### I2C in QUP
Configure I2C in kernel




== END ==
